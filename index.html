<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayMe å„ªæƒ </title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
        }
        h1 { 
            color: #0098ea; 
            margin-bottom: 10px;
            font-size: 28px;
        }
        .subtitle { 
            color: #666; 
            margin-bottom: 30px;
            font-size: 16px;
        }
        .header-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        .link-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        .link-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .price-tag {
            font-weight: bold;
            color: #0098ea;
            font-size: 1.1em;
        }
        .pay-btn {
            background: #0098ea;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            min-width: 80px;
            font-weight: 500;
            transition: background 0.2s;
        }
        .pay-btn:hover { 
            background: #0087d1; 
        }
        .pay-btn:disabled {
            background: #ccc;
            cursor: wait;
        }
        .pay-btn.loading-btn::after { 
            content: "..."; 
        }
        .note {
            font-size: 12px;
            color: #666;
            margin-top: 20px;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 6px;
            line-height: 1.5;
        }
        .note i {
            font-style: normal;
            background: #e3f2fd;
            padding: 2px 6px;
            border-radius: 4px;
            color: #0098ea;
        }
        .footer {
            margin-top: 20px;
            color: #999;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-icon">ğŸ’°</div>
        <h1>PayMe åˆ©æ˜¯å„ªæƒ </h1>
        <p class="subtitle">ç›´æ¥é»æ“Šé ˜å–ï¼Œè‡ªå‹•ç²å–æœ€æ–° Token</p>
        
        <div id="content-area">
            <div id="links-container">
                <!-- å‹•æ…‹åŠ è¼‰çš„é€£çµæœƒå‡ºç¾åœ¨é€™è£¡ -->
            </div>
            <div class="note">
                <i>âœ¨ æ¯åˆ†é˜è‡ªå‹•æ›´æ–° Token</i><br>
                ğŸ’¡ é»æ“Šã€Œé ˜å–ã€æœƒè‡ªå‹•ç²å–æœ€æ–° Token ä¸¦é–‹å•Ÿ PayMe<br>
                ğŸ”„ åˆ†äº«é€£çµç„¡æ•ˆï¼Œå¿…é ˆå¾æ­¤é é¢é ˜å–
            </div>
            <div class="footer">
                PayMe å„ªæƒ åˆé›† â€¢ å³æ™‚æ›´æ–°
            </div>
        </div>
    </div>

    <script>
        // HSBC API Key
        const HSBC_API_KEY = '9104b7e6-ded0-4998-a019-074477573c46';
        const HSBC_API_URL = 'https://paymepromotions.hsbc.com.hk/api/tc/draw/time-token';

        // PayMe å„ªæƒ é€£çµæ•¸æ“š
        const PAYME_LINKS = [
            { name: "æ–°åœ°å•†å ´è¬ç”¨åˆ¸ $3-$3", url: "https://payme.hsbc/m/fceca0c2-f866-490d-b788-5b2bba3dce49" },
            { name: "æ–°åœ°å•†å ´è¬ç”¨åˆ¸ $5-$5", url: "https://payme.hsbc/m/f0d9986d-3c24-4b9e-89e9-dbb8f3f3750b" },
            { name: "æ–°åœ°å•†å ´è¬ç”¨åˆ¸ $120-$8", url: "https://payme.hsbc/m/22387619-6afd-43fc-8d5c-11e38f2a4b9b" },
            { name: "æ–°åœ°å•†å ´è¬ç”¨åˆ¸ $168-$10", url: "https://payme.hsbc/m/43383635-5d9f-4464-bbac-d3fee38277c2" },
            { name: "æ–°åœ°å•†å ´è¬ç”¨åˆ¸ $800-$88", url: "https://payme.hsbc/m/3b9d6770-4948-4d29-ae01-a7e25a8278a5" },
            { name: "æ–°åœ°å•†å ´è¬ç”¨åˆ¸ $3800-$388", url: "https://payme.hsbc/m/bbdb9852-a09c-4720-9d52-eb7dcf090f16" },
            { name: "æ–°åœ°å•†å ´éŠ€è¯æ”¯ä»˜å›è´ˆåˆ¸ $500å›$38", url: "https://payme.hsbc/m/c3203e2b-44a3-47ad-a652-f73346683380" },
            { name: "æ–°åœ°å•†å ´éŠ€è¯æ”¯ä»˜å›è´ˆåˆ¸ $2000å›$128", url: "https://payme.hsbc/m/17d7c72e-5696-444e-95bb-25e66ba7372d" },
            { name: "ä¸¼ä¸¼å±‹ $100-$5", url: "https://payme.hsbc/m/8f1f8f5b-79d2-41f1-a786-566e919d6fa3" },
            { name: "ç‡’è‚‰LIKE $125-$5", url: "https://payme.hsbc/m/71373cb1-dfd2-479d-afc9-53b666dfdd6d" }
        ];

        // åˆå§‹åŒ–é é¢
        function initPage() {
            const container = document.getElementById('links-container');
            container.innerHTML = '';
            
            PAYME_LINKS.forEach(item => {
                const card = document.createElement('div');
                card.className = 'link-card';
                
                const btn = document.createElement('button');
                btn.className = 'pay-btn';
                btn.textContent = 'é ˜å–';
                btn.dataset.baseUrl = item.url;
                btn.onclick = function() { openPayMe(this); };
                
                card.innerHTML = `<span class="price-tag">${escapeHtml(item.name)}</span>`;
                card.appendChild(btn);
                container.appendChild(card);
            });
        }

        // ç²å– Token ä¸¦é–‹å•Ÿ PayMe
        async function openPayMe(button) {
            if (button.disabled) return;
            
            button.disabled = true;
            button.classList.add('loading-btn');
            const originalText = 'é ˜å–';
            button.textContent = 'ç²å–ä¸­';

            try {
                const response = await fetch(HSBC_API_URL, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Accept-Language': 'zh-HK,zh;q=0.9',
                        'Apikey': HSBC_API_KEY,
                        'Cache-Control': 'no-cache',
                        'Content-Type': 'application/json',
                        'Referer': 'https://paymepromotions.hsbc.com.hk/tc/game'
                    }
                });

                if (!response.ok) {
                    throw new Error(`ç„¡æ³•ç²å– Token (${response.status})`);
                }

                // HSBC è¿”å› "token"ï¼ˆæœ‰é›™å¼•è™Ÿï¼‰ï¼Œè¦ç§»é™¤
                let token = await response.text();
                token = token.trim().replace(/^"|"$/g, '');
                
                console.log('Token ç²å–æˆåŠŸ');

                const baseUrl = button.dataset.baseUrl;
                const separator = baseUrl.includes('?') ? '&' : '?';
                const fullUrl = `${baseUrl}${separator}token=${encodeURIComponent(token)}`;

                window.open(fullUrl, '_blank');

                button.textContent = 'âœ“ å·²é–‹å•Ÿ';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.disabled = false;
                    button.classList.remove('loading-btn');
                }, 2000);

            } catch (error) {
                console.error('ç²å– Token å¤±æ•—:', error);
                
                let errorMessage = 'ç„¡æ³•é€£æ¥ä¼ºæœå™¨';
                if (error.message.includes('Failed to fetch') || error.message.includes('CORS')) {
                    errorMessage = 'CORS éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦';
                } else {
                    errorMessage = error.message;
                }
                
                alert('âŒ ' + errorMessage);
                
                button.textContent = 'é‡è©¦';
                button.disabled = false;
                button.classList.remove('loading-btn');
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // é é¢åŠ è¼‰æ™‚åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
